---
title: "report.Rmd"
author: "Naomi Huber"
date: "2023-02-20"
output: html_document
---

#Report Exercise 3

Bevor ich die csv-Daten einlese, habe ich die Daten manuell bearbeitet und nur die relevanten Daten belassen. Anschliessend kann ich nun die Daten wie folgt einlesen:
```{r}
library(dtplyr)
library(tidyverse)

DatabaseS1 <- read.csv2("/Users/naomihuber/Desktop/UNIBE/05_FS23/Applied Geodata Science/agds_report_naomihuber/Datasets/Report Exercises 3.csv")

#Teilaufgabe 1
#Umwandeln von <chr>-Daten in <int>-Daten, damit gerechnet werden kann
DatabaseS1$ambient_CO2 <- as.integer(DatabaseS1$ambient_CO2)
DatabaseS1$increased_CO2 <- as.integer(DatabaseS1$increased_CO2)
DatabaseS1$Time_years <- as.numeric(DatabaseS1$Time_years)
DatabaseS1
```

Nun kann ich die Daten per Experiment filtern und anschliessend das log-response ratio für jedes Experiment berechnen. Dies habe ich wie folgt gemacht:
```{r}
#Teilaufgabe 2
#Aggregation nach den Experimenten mit den Mittelwertdaten
experimentdaten <- DatabaseS1 |>
  group_by(Experiment) |>
  summarise(Mittelwert_increased_CO2 = mean(increased_CO2),
            Mittelwert_ambient_CO2 = mean(ambient_CO2))
experimentdaten

#Funktion log_response_function definieren
log_response_function <- function(x,y) {
  return(log(x/y))
}

#Aggregation nach log_response ratio
experimentdaten_final <- experimentdaten |>
  group_by(Experiment) |>
  summarise(log_response_ratio = log_response_function(Mittelwert_increased_CO2, Mittelwert_ambient_CO2))
experimentdaten_final

knitr::kable(experimentdaten_final)
```

Zu guter Letzt gilt es neue Variablen zu erstellen, welchen ich die zuvor berechneten Daten zuordne. Dies habe ich so gemacht:
```{r}
#Teilaufgabe 3
#Die Variable "Phase" kreieren
DatabaseS1$phase <- ifelse(DatabaseS1$Time_years < 3, "early_phase",
                           ifelse(DatabaseS1$Time_years >= 3 & DatabaseS1$Time_years <= 6, "mid_phase",
                                  ifelse(DatabaseS1$Time_years > 6, "late_phase", NA)))


#Berechnung des log_response für jede Phase
log_response <- DatabaseS1 |>
  group_by(phase) |>
  summarise(log_response_ratio = mean(log(increased_CO2 / ambient_CO2))) |>
  drop_na()
log_response

knitr::kable(log_response)
```

