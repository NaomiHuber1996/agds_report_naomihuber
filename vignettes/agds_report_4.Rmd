---
title: "agds_report_4"
author: "Naomi Huber"
date: "2023-03-13"
output: html_document
---

```{r}
#  exercise 4 (first plot)
library(tidyverse)

# first visualisation
# download ot the airquality-data
airquality <- datasets::airquality

# filter of the May-data
may_dates <- subset(airquality, Month == 5)
may_dates <- may_dates |>
  group_by(Day) |>
  summarise(temperatures_f = (Temp))

# generating an average temperature of May
mean_temperature_may <- subset(airquality, Month ==5)
mean_temperature_may <- mean_temperature_may |>
  group_by(Month) |>
  summarise(mean_temperature = mean(Temp))

# Figure 1 "Daily Temperature (F°) in May"
ggplot(
  data = may_dates,
  aes(Day, temperatures_f)) +
  geom_line(color = "red4") +
  geom_abline(slope = 0, intercept = 65.54839) +
  labs(title = "Daily Temperature (F°) in May",
       x = "Days in May",
       y = "Temperature (F°)") + 
  theme_grey()

```

The first visualization of the dataset shows the daily temperature in the month of May. Looking at the graph, one finds the days in the month may on the x-axis and the temperatures on the y-axis. The temperature is given in Fahrenheit. Furthermore, the average monthly temperature is marked with the black line which is about 65° F. Regarding the statistical metrics used it becomes clear that the visualiza-tion one uses the mean because this metric is well known and already used in meteorological reporting. Additionally, the average temperature can be compared to the average temperatures in other years and trends can be calculated.

Regarding the graph one can notice a trend of warmer temperatures to the end of May. This makes sense because summer will come. Also, one can report temperature fluctuations which is due to a measurement location in the temperate latitudes.  


```{r}
# Report Exercise 4 (second plot)
library(tidyverse)
library(ggpubr)

# second visualisation
# download ot the airquality-data
airquality <- datasets::airquality

# generating of sequential numbering
airquality <- airquality |>
  mutate(row_num = row_number())

# filter of the relevant data (here: ozone and temperature)
ozone_days <- subset(airquality, Ozone & row_num)
ozone_days <- ozone_days |>
  group_by(row_num) |>
  summarise(ozone_concentration = Ozone)

temp_days <- subset(airquality, Temp & row_num)
temp_days <- temp_days |>
  group_by(row_num) |>
  summarise(temperature = Temp)


# correlation of ozone and temperature
plot_ozone <- ggplot(
  data = ozone_days,
  aes(row_num, ozone_concentration)) +
  geom_point(color = "blue4") +
  labs(x = "Days (May - Sep)",
       y = "Ozone Concentration")
  theme_classic()
plot_ozone

plot_temperature <- ggplot(
  data = temp_days,
  aes(row_num, temperature)) +
  geom_point(color = "red4") +
  labs(x = "Days (May - Sep)",
       y = "Temperature (F°)")
theme_classic()
plot_temperature

# combination of the two plots
ggarrange(plot_ozone, plot_temperature, nrow = 2, common.legend = TRUE, legend = "bottom")
```

In the second visualization the lower graph shows the daily temperatures (in Fahrenheit) from the beginning of May to the end of September. The upper visualization pictures the ozone concentration in the same time spectrum. The used statistical metric is the correlation. One can notice a connection between rising temperatures and a higher concentration in the ozone. Nevertheless, there are maybe some out layers in the concentration of ozone around day 30, day 60 and day 120. 

As a hypothesis one can assume that the warmer the atmosphere becomes, the more ozone can be produced. But the influencing factor of the solar radiation is not considered.



```{r}
# Report Exercise 4 (third plot)
library(tidyverse)

# third visualisation
# download ot the airquality-data
airquality <- datasets::airquality

# generating of sequential numbering
airquality <- airquality |>
  mutate(row_num = row_number())

# filter of the relevant data
solar_radiaton <- subset(airquality, Solar.R & Temp)
solar_radiaton <- solar_radiaton |>
  group_by(Temp) |>
  summarise(solar.radiaton = Solar.R)

# correlation of rolar.radiation and temperature
ggplot(
  data = solar_radiaton,
  aes(solar.radiaton, Temp)) +
  geom_point(color = "violet") +
  geom_smooth(method = "lm", color = "orange4") +
  labs(x = "Solarradiation",
       y = "Temperature")
theme_classic()
```


Regarding the third visualization the solar radiation is located on the x-axis and the temperature can be found on the y-axis. As a hypothesis one can assume that a higher solar radiation leads to higher temperatures. Nonetheless, the values are scattered in the plot, and it is very difficult to get concrete information out of it. Therefore, it is useful to display a trend line, which is not an actual statistical metric but arises out of them such as for example the regression analysis. Anyhow one can record low temperatures measured although the solar radiation measured was high. It can be assumed that this may be an out layer or that the sky was covered by thick clouds. These could have suppressed the potential temperature rise. But considering the trend line it becomes clear that a higher solar radiation favors higher temperatures. 
